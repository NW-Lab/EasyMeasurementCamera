# 出来そうな機能

このドキュメントは EasyShareCamera の設計方針（教育用途・Master/Remote カメラ・画像共有機能は不要）に基づき、実装可能な機能候補を機能中心に整理したものです。
各機能について、簡潔な説明、想定されるユーザ価値、実装メモ（使用 API / 優先度 / 難易度）を記載しています。

**重要**: 画像の共有機能はこのアプリには含まず、撮影データは標準の写真アプリに保存して共有はそちらに任せます。

---

## 1. Master → Remote の設定同期
- 説明: Master カメラで設定した撮影パラメータを Remote カメラ群へリアルタイムまたは即時反映する。
  - **制御可能なパラメータ**: ISO感度、露出時間、フォーカス位置、ホワイトバランス、解像度、フレームレート
  - **制御不可**: 絞り（F値は物理的に固定）、従来の「シャッタースピード」（露出時間として制御）
- ユーザ価値: 受講者全員で同一条件の撮影が可能になり、実験の再現性が高まる。
- 実装メモ:
  - 使用 API: AVFoundation（AVCaptureDevice.iso, exposureDuration, lensPosition, whiteBalanceMode など）
  - 通信: MultipeerConnectivity（ローカル Wi‑Fi/Peer-to-Peer）
  - データ形式: JSON で設定ペイロードを定義
  - 優先度: 最重要
  - 難易度: 中

## 2. 同時シャッター／同時録画トリガ
- 説明: Master のシャッター操作や録画開始/停止を Remote へほぼ同時に伝播し、時間同期された撮影を行う。遅延を最小化する。
- ユーザ価値: 同時刻での撮影が必要な物理実験で有用（時間差を最小化）。
- 実装メモ:
  - 同期方式: ローカルブロードキャストでの即時トリガ、タイムスタンプ＋遅延推定で補正
  - 通信: MultipeerConnectivity またはローカル UDP ブロードキャスト
  - 優先度: 最重要
  - 難易度: 中〜高（ネットワーク遅延の補正が重要）

## 3. 高速撮影（ハイスピード・スローモーション）サポート
- 説明: 高フレームレート撮影の設定・制御を行い、Master の設定を Remote に適用する。物理現象の詳細観察に使用。
- ユーザ価値: 衝突や振動など高速現象の観察・解析が可能になる。
- 実装メモ:
  - 使用 API: AVFoundation（AVCaptureDevice、AVCaptureSession、AVCaptureMovieFileOutput）
  - 注意点: デバイス依存（iPhone モデルによる上限フレームレート）
  - 優先度: 高
  - 難易度: 中

## 4. Apple標準カメラUI風のインターフェース
- 説明: ユーザが慣れ親しんだ Apple 標準カメラアプリに近い UI/UX を提供する。
- ユーザ価値: 学習コストを下げ、直感的に操作できる。
- 実装メモ:
  - UI フレームワーク: SwiftUI または UIKit でカメラコントロールを模倣
  - カメラ操作: AVFoundation の標準的な実装パターンを使用
  - 優先度: 高
  - 難易度: 中

## 5. 外部ハードウェアトリガ（マイコン連携）
- 説明: 外部マイコンやセンサーからの物理トリガで撮影を開始。Master はその信号を受けて Remote へ伝播する。
- ユーザ価値: 実験での正確なトリガ制御（例: 衝突検知時点で一斉シャッター）に有効。
- 実装メモ:
  - 接続方法: BLE 経由でマイコンと通信
  - 優先度: 中（将来実装）
  - 難易度: 高（ハードウェア設計/ファームウェア連携が必要）

## 6. 撮影メタデータの自動記録
- 説明: 各撮影にタイムスタンプ、カメラ設定、実験ラベルなどのメタデータを付与。写真アプリに保存される際に EXIF に記録。
- ユーザ価値: 実験データの整理と後での検索が容易になる。
- 実装メモ:
  - 保存方法: EXIF データへの書き込み、または写真アプリの Albums 機能を活用
  - 優先度: 中
  - 難易度: 低

## 7. 撮影同期の遅延測定・診断ツール
- 説明: ネットワーク遅延を測定して、シャッター同期時の精度を確認・調整できる。
- ユーザ価値: 同時撮影の品質を向上させるための運用サポート。
- 実装メモ:
  - 実装: RTT 測定、タイムスタンプ交換、統計的な遅延推定
  - 優先度: 中
  - 難易度: 中

## 8. カメラ接続状態の可視化
- 説明: Master と各 Remote カメラの接続状態、電池残量、ストレージ残量等をリアルタイム表示。
- ユーザ価値: 実験前の準備確認と、実験中のトラブル早期発見に有効。
- 実装メモ:
  - 情報取得: デバイス情報 API（UIDevice、AVCaptureDevice）
  - UI: 接続されたデバイス一覧の表示
  - 優先度: 中
  - 難易度: 低〜中

## 9. 簡易実験テンプレート機能
- 説明: 「落下実験」「振り子」「衝突」などの実験パターンに応じたカメラ設定のプリセットを提供。
- ユーザ価値: 教育現場で素早くセットアップできる。
- 実装メモ:
  - 設定保存: UserDefaults または JSON ファイルでプリセット管理
  - 優先度: 低〜中
  - 難易度: 低

## 10. デバイス探索・ペアリング機能
- 説明: 近くにある EasyShareCamera を実行している他のデバイスを自動検出し、Master/Remote の役割を設定できる。
- ユーザ価値: 複数台での運用開始が簡単になる。
- 実装メモ:
  - 使用 API: MultipeerConnectivity のブラウザ・アドバタイザ機能
  - 優先度: 高
  - 難易度: 中

---

## iPhone/iPad カメラ機能差異

### 主要デバイス比較表

| 機能 | iPhone 15 Pro | iPhone 15 | iPhone 14 | iPad Pro (M2) | iPad Air (M1) | 備考 |
|------|---------------|-----------|-----------|---------------|---------------|------|
| **メインカメラ絞り** | F1.78 固定 | F1.6 固定 | F1.5 固定 | F1.8 固定 | F1.8 固定 | 物理的固定値 |
| **スローモーション** | 240fps@1080p<br>120fps@4K | 240fps@1080p | 240fps@1080p | 240fps@1080p | 240fps@1080p | 高速撮影対応 |
| **4K録画** | ○ (最大60fps) | ○ (最大60fps) | ○ (最大60fps) | ○ (最大60fps) | ○ (最大30fps) | 解像度制御 |
| **ProRAW/ProRes** | ○ | × | × | × | × | 高品質撮影 |
| **望遠レンズ** | ○ (3倍) | × | × | × | × | 複数レンズ |
| **超広角レンズ** | ○ | ○ | ○ | ○ | ○ | 広角撮影 |
| **LiDAR** | ○ | × | × | ○ | × | 距離測定・AF |
| **アクションモード** | ○ | ○ | ○ | × | × | 手ブレ補正 |

### 制御可能な撮影パラメータ（AVFoundation）

| パラメータ | 制御方法 | 対応デバイス | 備考 |
|------------|----------|--------------|------|
| **ISO感度** | `AVCaptureDevice.iso` | 全デバイス | 29〜2304（機種により上限差異） |
| **露出時間** | `AVCaptureDevice.exposureDuration` | 全デバイス | 1/24000〜1/3秒程度 |
| **フォーカス** | `AVCaptureDevice.lensPosition` | 全デバイス | 0.0〜1.0（無限遠〜最近距離） |
| **ホワイトバランス** | `AVCaptureDevice.whiteBalanceMode` | 全デバイス | オート/ロック/手動 |
| **フレームレート** | `AVCaptureDevice.activeVideoMinFrameDuration` | 全デバイス | 24/30/60/120/240fps |
| **ズーム** | `AVCaptureDevice.videoZoomFactor` | 全デバイス | デジタル/光学（レンズ数による） |
| **解像度** | `AVCaptureSession.sessionPreset` | 全デバイス | 480p〜4K |

### 教育用途での推奨構成

**Master カメラ（推奨）**: iPhone 15 Pro
- 理由: 全機能対応、ProRAW/ProRes、複数レンズ、LiDAR

**Remote カメラ（推奨）**: iPhone 14 以降 または iPad Air (M1) 以降
- 理由: スローモーション 240fps 対応、十分な撮影性能、コストバランス

**最小構成**: iPhone 12 以降 または iPad (第9世代) 以降
- 理由: AVFoundation 基本機能、スローモーション対応

---

### 作業手順・実装優先度について

詳細な作業手順、開発フェーズ、実装優先度については `ToDo/作業手順.md` を参照してください。
このファイルは機能候補の技術的詳細に特化しています。
