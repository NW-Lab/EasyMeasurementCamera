# 水滴供給システムガイド

このドキュメントでは、ミルククラウン撮影のための2つの水滴供給方式を詳しく解説します。

## 目次

1. [2つの方式の概要](#2つの方式の概要)
2. [方式1: 自然落下（マリオット瓶 + 点滴セット）](#方式1-自然落下マリオット瓶--点滴セット)
3. [方式2: 電磁弁制御](#方式2-電磁弁制御)
4. [詳細な比較](#詳細な比較)
5. [推奨される段階的アプローチ](#推奨される段階的アプローチ)

## 2つの方式の概要

ミルククラウン撮影では、安定した水滴を供給することが成功の鍵です。本プロジェクトでは、2つの方式を提供します。

| 方式 | 特徴 | 推奨用途 |
|---|---|---|
| **自然落下** | シンプル、プログラミング不要 | 最初のテスト、学習用 |
| **電磁弁制御** | 高精度、柔軟な制御 | イベント、高度な撮影 |

## 方式1: 自然落下（マリオット瓶 + 点滴セット）

### システム構成図

```
        スタンド
           │
    ┌──────┴──────┐
    │ マリオット瓶 │ ← 密閉容器（ペットボトル）
    │  （逆さま） │
    │             │
    │  ← 大気圧導入穴（直径1-2mm）
    │             │
    │  エアチューブ │ ← 水面より5-10cm上
    │     ↑       │
    │   水 ↑      │
    │     ↓       │
    │  点滴セット  │
    └─────┬───────┘
          │
      調整ダイヤル ← 流量調整
          │
       ノズル
          │
          ↓
       水滴（自然落下）
          ↓
    フォトカプラ（30cm下）
          ↓
       受け皿
```

### 必要な材料

| 材料 | 仕様 | 価格（目安） | 入手先 |
|---|---|---|---|
| ペットボトル | 500ml〜1L、透明 | 0円 | 手持ち |
| 点滴セット | 医療用輸液セット | 500円〜 | Amazon、楽天、薬局 |
| エアチューブ | 内径4〜6mm、長さ30〜50cm | 200円 | ホームセンター、熱帯魚店 |
| ホットグルー | 防水用 | 300円 | 100円ショップ |
| PTFEテープ | 配管用シール材 | 200円 | ホームセンター |

**合計**: 約1,200円

### 作り方

詳細な作り方は、[マリオット瓶の作り方ガイド](MARIOTTE_BOTTLE_GUIDE.md)を参照してください。

### 利点

- **シンプル**: プログラミング不要
- **低コスト**: 約1,200円で構築可能
- **安定性**: 水圧が常に一定
- **故障が少ない**: 機械的な部品が少ない

### 欠点

- **柔軟性が低い**: 水滴のサイズはノズル径で固定
- **複数水滴不可**: 1つずつしか落とせない
- **自動化不可**: 手動で調整ダイヤルを操作

### 適用シーン

- 最初のシステム理解とテスト
- 基本的な物理の学習
- シンプルなデモンストレーション
- バックアップシステム

## 方式2: 電磁弁制御

電磁弁制御には、2つのパターンがあります。

### パターンA: 開放容器（シンプル版）

#### システム構成図

```
        スタンド
           │
    ┌──────┴──────┐
    │   容器      │ ← 開放容器（上が開いている）
    │             │
    │   水        │
    │             │
    │     ↓       │
    └─────┬───────┘
          │
       チューブ（内径8mm）
          │
    ┌─────┴───────┐
    │   電磁弁     │ ← XIAO制御
    │  (12V N/C)   │
    └─────┬───────┘
          │
       ノズル
          │
          ↓
       水滴（強制放出）
          ↓
    フォトカプラ（30cm下）
          ↓
       受け皿
```

#### 必要な材料

| 材料 | 仕様 | 価格（目安） | 入手先 |
|---|---|---|---|
| プラスチック容器 | 1L程度、上が開放 | 200円 | 100円ショップ |
| チューブ | 内径8mm、長さ50cm | 300円 | ホームセンター |
| 電磁弁 | 12V、2ウェイ、N/C | 2,000円 | Amazon、AliExpress |
| ノズル | 内径1-3mm、真鍮製 | 300円 | ホームセンター |
| トランジスタ | TIP120 | 100円 | 秋月電子、Amazon |
| ダイオード | 1N4007 | 50円 | 秋月電子、Amazon |
| 抵抗 | 1kΩ | 10円 | 秋月電子、Amazon |
| 12V電源 | 1A以上 | 1,000円 | Amazon |

**合計**: 約4,000円

#### 利点

- **非常にシンプル**: 開放容器なので組み立てが簡単
- **水の補充が簡単**: 蓋を開けずに水を注げる
- **柔軟な制御**: 水滴のサイズと個数を自由に制御
- **プログラミング学習**: Arduinoの制御を学べる

#### 欠点

- **水圧が不安定**: 水位が下がると水圧が変わる
- **短時間向き**: 長時間の使用には不向き

#### 適用シーン

- 電磁弁制御の学習
- プログラミングの開発とテスト
- 短時間のデモンストレーション

### パターンB: マリオット瓶（高精度版）

#### システム構成図

```
        スタンド
           │
    ┌──────┴──────┐
    │ マリオット瓶 │ ← 密閉容器（水圧一定）
    │  （逆さま） │
    │             │
    │  ← 大気圧導入穴
    │             │
    │  エアチューブ │
    │     ↑       │
    │   水 ↑      │
    │     ↓       │
    └─────┬───────┘
          │
       チューブ（内径8mm）
          │
    ┌─────┴───────┐
    │   電磁弁     │ ← XIAO制御
    │  (12V N/C)   │
    └─────┬───────┘
          │
       ノズル
          │
          ↓
       水滴（強制放出）
          ↓
    フォトカプラ（30cm下）
          ↓
       受け皿
```

#### 必要な材料

パターンAの材料に加えて:

| 材料 | 仕様 | 価格（目安） | 入手先 |
|---|---|---|---|
| ペットボトル | 500ml〜1L、透明 | 0円 | 手持ち |
| エアチューブ | 内径4〜6mm、長さ30〜50cm | 200円 | ホームセンター |
| ホットグルー | 防水用 | 300円 | 100円ショップ |
| PTFEテープ | 配管用シール材 | 200円 | ホームセンター |

**合計**: 約4,700円

#### 利点

- **最高の精度**: 水圧が常に一定
- **長時間安定**: イベントでの長時間使用に最適
- **柔軟な制御**: 水滴のサイズと個数を自由に制御
- **再現性が高い**: 同じ設定で常に同じ結果

#### 欠点

- **構造が複雑**: マリオット瓶の組み立てが必要
- **調整に時間**: エアチューブの高さ調整が必要

#### 適用シーン

- イベントでの使用
- 長時間の撮影
- 高精度が必要な実験
- 複数台のiPhone同期撮影

## 詳細な比較

### 容器の構造

| 項目 | 自然落下 | 電磁弁（開放） | 電磁弁（マリオット） |
|---|---|---|---|
| **容器のタイプ** | 密閉 | **開放** | 密閉 |
| **蓋** | 必須 | **不要** | 必須 |
| **エアチューブ** | 必須 | **不要** | 必須 |
| **大気圧導入穴** | 必須 | **不要** | 必須 |
| **組み立ての難易度** | 中 | **低** | 中 |

### 性能比較

| 項目 | 自然落下 | 電磁弁（開放） | 電磁弁（マリオット） |
|---|---|---|---|
| **水圧の安定性** | ◎ | △ | ◎ |
| **水滴サイズ** | 固定 | 可変 | 可変 |
| **水滴個数** | 1個 | 可変 | 可変 |
| **複雑なパターン** | 不可 | 可能 | 可能 |
| **長時間の安定性** | ◎ | △ | ◎ |
| **イベント向き** | ○ | △ | ◎ |

### コスト比較

| 項目 | 自然落下 | 電磁弁（開放） | 電磁弁（マリオット） |
|---|---|---|---|
| **部品コスト** | 約1,200円 | 約4,000円 | 約4,700円 |
| **プログラミング** | 不要 | 必要 | 必要 |
| **調整の時間** | 短い | 中 | 長い |

## 推奨される段階的アプローチ

本プロジェクトでは、以下の3段階のアプローチを推奨します。

### ステップ1: 自然落下でシステムを理解する

**目的**: 基本的な仕組みを理解し、水滴のサイズと落下時間を確認する

**使用する方式**: マリオット瓶 + 点滴セット

**作業内容**:
1. [マリオット瓶の作り方ガイド](MARIOTTE_BOTTLE_GUIDE.md)に従って、マリオット瓶を作る
2. 点滴セットを接続
3. フォトカプラで水滴を検知
4. 赤色LEDと白色LEDを点灯（Arduinoコード: `arduino/water_drop_trigger/`）
5. iPhoneアプリで撮影テスト

**この段階で確認すること**:
- [ ] 水滴のサイズは適切か？（目標: 3〜5mm）
- [ ] 落下時間（約247ms）は正確か？
- [ ] フォトカプラは正常に動作するか？
- [ ] LEDの明るさは十分か？
- [ ] iPhoneは赤色を検知できるか？

**所要時間**: 2〜3時間

### ステップ2: 電磁弁（開放容器）で制御を学ぶ

**目的**: 電磁弁の制御とプログラミングを習得する

**使用する方式**: 開放容器 + 電磁弁

**作業内容**:
1. 開放容器と電磁弁を接続
2. Arduinoで電磁弁を制御するプログラムを書く
3. 開放時間を変えて、水滴サイズを調整
4. 複数の水滴を連続して落とす実験

**この段階で確認すること**:
- [ ] 電磁弁は正常に動作するか？
- [ ] 開放時間と水滴サイズの関係は？
- [ ] 複数の水滴を落とせるか？
- [ ] タイミング制御は正確か？

**所要時間**: 3〜4時間

### ステップ3: 電磁弁（マリオット瓶）で完成形を目指す

**目的**: イベントで使用できる完成度の高いシステムを構築する

**使用する方式**: マリオット瓶 + 電磁弁

**作業内容**:
1. マリオット瓶と電磁弁を接続
2. 長時間の安定動作をテスト
3. 最適な設定を見つける
4. イベントでのリハーサル

**この段階で確認すること**:
- [ ] 長時間（1時間以上）安定して動作するか？
- [ ] 水を補充しても設定が変わらないか？
- [ ] 複数台のiPhoneで同期撮影できるか？

**所要時間**: 4〜5時間

## まとめ

### どちらの方式を選ぶべきか？

| あなたの状況 | 推奨方式 |
|---|---|
| 初めてミルククラウン撮影に挑戦 | **自然落下** |
| プログラミングを学びたい | **電磁弁（開放容器）** |
| イベントで使用したい | **電磁弁（マリオット瓶）** |
| 複雑な水滴パターンを試したい | **電磁弁（マリオット瓶）** |
| 予算を抑えたい | **自然落下** |

### 両方の方式を残す理由

- **自然落下**: シンプルで故障が少ない。バックアップとして残しておくと安心。
- **電磁弁**: 柔軟性が高く、複雑なパターンが可能。イベントでの「目玉」になる。

両方のシステムを用意しておけば、イベント当日に片方が故障しても、もう片方で対応できます。

## 関連ドキュメント

- [マリオット瓶の作り方ガイド](MARIOTTE_BOTTLE_GUIDE.md)
- [Arduino回路とコード](../arduino/README.md)
- [開発ガイド](../DEVELOPMENT.md)
- [メインREADME](../README.md)
